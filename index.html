<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GollGlobal • Impact Dashboard (Prototype)</title>

  <style>
    :root{
      --blue:#0b99cc; --muted:#6b7280; --bg:#f8fafc; --card:#ffffff; --line:#e5e7eb;
      --pink:#f59eb6;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;background:var(--bg);color:#0f172a}
    header{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--line);z-index:5}
    .bar{max-width:1200px;margin:0 auto;display:flex;align-items:center;gap:14px;padding:14px 16px}
    .brand h1{font-size:22px;margin:0}
    .brand small{color:var(--muted)}
    nav{margin-left:auto;display:flex;flex-wrap:wrap;gap:8px}
    nav button{border:1px solid #d9e3ef;background:#fff;border-radius:999px;padding:8px 14px}
    nav button.active{background:var(--blue);color:#fff;border-color:var(--blue)}
    main{max-width:1200px;margin:24px auto;padding:0 16px}
    .section{display:none;animation:fade .25s ease}
    .section.active{display:block}
    @keyframes fade{from{opacity:.3;transform:translateY(4px)} to{opacity:1;transform:none}}
    .grid{display:grid;gap:16px}
    .cols-3{grid-template-columns:repeat(3,1fr)}
    @media (max-width:980px){.cols-3{grid-template-columns:1fr}}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:16px}
    h2,h3{margin:.2rem 0 .8rem 0}
    .muted{color:var(--muted)}
    .legend{display:flex;gap:10px;align-items:center;margin-top:6px}
    .dot{width:10px;height:10px;border-radius:50%}
    .pill{background:#e6f5fb;color:#036fa1;border-radius:8px;padding:2px 8px;font-size:12px}
    footer{max-width:1200px;margin:24px auto;padding:8px 16px;color:var(--muted)}
    .chartBox{position:relative;height:260px}
    @media (min-width:900px){.chartBox{height:320px}}
    #map{height:360px;border-radius:14px;border:1px solid var(--line)}
  </style>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#0b99cc" />
</head>
<body>
<header>
  <div class="bar">
    <div class="brand">
      <h1>Impact Dashboard</h1>
      <small>Sauberes Trinkwasser für alle – überall, jederzeit.</small>
    </div>
    <nav id="nav">
      <button class="active" data-target="overview">Übersicht</button>
      <button data-target="impact">Impact</button>
      <button data-target="mapSec">Karte</button>
      <button data-target="media">Medien</button>
      <button data-target="shop">Pre-Order</button>
      <button data-target="about">Projekt</button>
    </nav>
  </div>
</header>

<main>
  <section id="overview" class="section active">
    <div class="card">
      <span class="pill">Prototype</span>
      <h2>Atmospheric Water Generator (AWG)</h2>
      <p class="muted">Tragbares Gerät, 10–15 L/Tag, Solar/Akku, 5‑Stufen‑Filter.
        Buy‑One‑Give‑One + Recycling‑Programm. Ab <b>2030</b> spenden wir
        für jede NGO‑vermittelte Spende eine <b>gleich hohe</b> Anzahl Geräte (Spenden = Verkäufe).</p>
    </div>

    <div class="grid cols-3" style="margin-top:14px">
      <div class="card">
        <h3>Umsatz / Gewinn</h3>
        <div class="chartBox"><canvas id="revChart"></canvas></div>
        <div class="legend">
          <div class="dot" style="background:#2f86eb"></div>Umsatz (Mio €)
          <div class="dot" style="background:#f59eb6"></div>Gewinn (Mio €)
        </div>
      </div>
      <div class="card">
        <h3>Geräte p.a.</h3>
        <div class="chartBox"><canvas id="unitsChart"></canvas></div>
        <div class="legend">
          <div class="dot" style="background:#2f86eb"></div>Verkaufte Geräte
          <div class="dot" style="background:#f59eb6"></div>Gespende­te Geräte
        </div>
      </div>
      <div class="card">
        <h3>Spenden p.a.</h3>
        <div class="chartBox"><canvas id="donChart"></canvas></div>
        <div class="legend">
          <div class="dot" style="background:#2f86eb"></div>Spenden (Mio €)
          <div class="dot" style="background:#f59eb6"></div>Fee an GollGlobal (Mio €)
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:14px">
      <h3>Hinweis: Demo & Annahmen</h3>
      <ul class="muted">
        <li>Zahlen sind Modellannahmen; ändern sich mit echten Daten.</li>
        <li>Ab 2030: <b>Spenden = Verkäufe</b> (Demo‑Szenario).</li>
        <li>Filter‑Abo 5 €/Monat; Plattform‑Fee 5 % (bis 2037), dann 20 % ab 2038 (eigene Produktion).</li>
      </ul>
    </div>
  </section>

  <section id="impact" class="section">
    <div class="card">
      <h3>Impact‑Network</h3>
      <p class="muted">Empfehlungen ohne Geldprämien – nur Impact‑Punkte. NGOs, Creator, Vereine
        & Unternehmen teilen ihren Link und sehen transparent, was bewirkt wurde.</p>
      <div class="grid cols-3" style="margin-top:8px">
        <div class="card"><b>Aktive Botschafter</b><br><span class="muted" id="ambassadors">–</span></div>
        <div class="card"><b>Empfehlungen</b><br><span class="muted" id="referrals">–</span></div>
        <div class="card"><b>Wasser erzeugt (L)</b><br><span class="muted" id="waterLiters">–</span></div>
      </div>
    </div>
  </section>

  <section id="mapSec" class="section">
    <div class="card"><h3>Einsatzorte</h3>
      <div id="map"></div>
    </div>
  </section>

  <section id="media" class="section">
    <div class="card"><h3>Fotos & Videos</h3>
      <div class="grid" style="grid-template-columns:repeat(2,1fr)">
        <img src="https://images.unsplash.com/photo-1505744386214-51dba16a26fc?q=80&w=1200&auto=format&fit=crop" alt="AWG 1" style="width:100%;border-radius:12px">
        <img src="https://images.unsplash.com/photo-1521207418485-99c705420785?q=80&w=1200&auto=format&fit=crop" alt="AWG 2" style="width:100%;border-radius:12px">
      </div>
      <div style="margin-top:12px">
        <iframe width="100%" height="240" style="border:0;border-radius:12px"
                src="https://www.youtube.com/embed/dQw4w9WgXcQ"
                title="Demo Video" allowfullscreen></iframe>
      </div>
    </div>
  </section>

  <section id="shop" class="section">
    <div class="card">
      <h3>Pre‑Order (Demo)</h3>
      <p><b>GollGlobal AWG</b> – 1.499 € (Ziel‑VK), inkl. Recycling‑Programm.</p>
      <a class="btn" href="mailto:info@gollglobal.org?subject=Pre-Order%20AWG">Anfragen</a>
    </div>
  </section>

  <section id="about" class="section">
    <div class="card">
      <h3>Projekt</h3>
      <p class="muted">Mission: Sauberes Trinkwasser für alle. Buy‑One‑Give‑One,
        lokale Partner, transparente Daten. Eigene Produktion ab 2038 → höhere Marge & Spenden‑Fee.</p>
    </div>
  </section>
</main>

<footer>© GollGlobal — Prototype • Branding‑Version (ohne Bildlogo, damit es überall lädt)</footer>

<script>
  const cfg = {
    START_YEAR: 2028,
    END_YEAR: 2035,
    START_PARITY_YEAR: 2030,
    PRICE_PER_DEVICE: 1499,
    GROSS_MARGIN_RATE: 0.30,
    DONATION_FEE_EARLY: 0.05,
    DONATION_FEE_LATE: 0.20,
    PEOPLE_PER_DEVICE: 5,
    LITERS_PER_DEVICE_PER_DAY: 12
  };

  const years = Array.from({length: cfg.END_YEAR - cfg.START_YEAR + 1},
    (_,i)=>cfg.START_YEAR+i);

  const salesBase = {
    2028:15000, 2029:36000, 2030:45000, 2031:61000,
    2032:76000, 2033:99000, 2034:118000, 2035:145000
  };

  function donatedForYear(y){
    if(y < cfg.START_PARITY_YEAR){
      const map = {2028:7500, 2029:18000, 2030:22500, 2031:30500, 2032:38000, 2033:50000, 2034:59000, 2035:72000};
      return map[y] ?? Math.round((salesBase[y]||0)*0.45);
    }
    return salesBase[y]||0;
  }

  const labels = years.map(String);
  const unitsSold = years.map(y => salesBase[y]||0);
  const unitsDon = years.map(y => donatedForYear(y));

  const revenue = unitsSold.map(n => Math.round(n * cfg.PRICE_PER_DEVICE / 1e6));
  const profit  = revenue.map(v => Math.round(v * cfg.GROSS_MARGIN_RATE));

  const donationPerDevice = 500;
  const donationVol = unitsDon.map(n => Math.round((n * donationPerDevice) / 1e6));
  const fees = years.map((y,i)=>{
    const rate = (y<=2037)? cfg.DONATION_FEE_EARLY : cfg.DONATION_FEE_LATE;
    return Math.round(donationVol[i] * rate);
  });

  const totalPeople = (unitsSold.reduce((a,b)=>a+b,0)+unitsDon.reduce((a,b)=>a+b,0)) * cfg.PEOPLE_PER_DEVICE;
  const waterLiters = (unitsSold.reduce((a,b)=>a+b,0)+unitsDon.reduce((a,b)=>a+b,0)) * cfg.LITERS_PER_DEVICE_PER_DAY * 365;

  const tickFmt = v => new Intl.NumberFormat('de-DE').format(v);
  const baseOptions = {
    responsive:true, maintainAspectRatio:false,
    scales:{
      x:{ grid:{display:false}, ticks:{ color:'#4b5563',font:{size:12} } },
      y:{ beginAtZero:true, grid:{color:'rgba(0,0,0,.08)'},
          ticks:{ color:'#4b5563', font:{size:12}, callback:tickFmt } }
    },
    plugins:{
      legend:{ position:'bottom', labels:{boxWidth:12} },
      tooltip:{ callbacks:{ label:(ctx)=>{
        const val = tickFmt(ctx.parsed.y ?? ctx.parsed);
        return `${ctx.dataset.label}: ${val}`;
      }}}
    },
    animation:false
  };

  new Chart(document.getElementById('revChart'),{
    type:'line',
    data:{
      labels,
      datasets:[
        {label:'Umsatz (Mio €)', data:revenue, borderColor:'#2f86eb', backgroundColor:'rgba(47,134,235,.15)', tension:.25, fill:true},
        {label:'Gewinn (Mio €)', data:profit,  borderColor:'#f59eb6', backgroundColor:'rgba(245,158,182,.15)', tension:.25, fill:true}
      ]
    },
    options: baseOptions
  });

  new Chart(document.getElementById('unitsChart'),{
    type:'bar',
    data:{
      labels,
      datasets:[
        {label:'Verkaufte Geräte', data:unitsSold, backgroundColor:'#2f86eb'},
        {label:'Gespendete Geräte', data:unitsDon, backgroundColor:'#f59eb6'}
      ]
    },
    options: baseOptions
  });

  new Chart(document.getElementById('donChart'),{
    type:'bar',
    data:{
      labels,
      datasets:[
        {label:'Spenden (Mio €)', data:donationVol, backgroundColor:'#2f86eb'},
        {label:'Fee an GollGlobal (Mio €)', data:fees, backgroundColor:'#f59eb6'}
      ]
    },
    options: baseOptions
  });

  document.getElementById('ambassadors').textContent = '1.500+';
  document.getElementById('referrals').textContent   = '85.000+';
  document.getElementById('waterLiters').textContent = new Intl.NumberFormat('de-DE').format(waterLiters);

  const map = L.map('map',{scrollWheelZoom:false}).setView([15,10], 2.2);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
    attribution:'© OpenStreetMap'
  }).addTo(map);

  const sites = [
    {name:'Nairobi, Kenia',    lat:-1.286, lng:36.817},
    {name:'Accra, Ghana',      lat:5.560,  lng:-0.205},
    {name:'Cali, Kolumbien',   lat:3.451,  lng:-76.532},
    {name:'Goa, Indien',       lat:15.299, lng:74.124}
  ];
  sites.forEach(s=>{
    L.marker([s.lat,s.lng]).addTo(map).bindPopup(`<b>${s.name}</b><br>AWG-Deploy (Demo)`);
  });

  document.getElementById('nav').addEventListener('click', (e)=>{
    if(e.target.tagName!=='BUTTON') return;
    const t = e.target.dataset.target;
    document.querySelectorAll('nav button').forEach(b=>b.classList.toggle('active', b.dataset.target===t));
    document.querySelectorAll('.section').forEach(s=>s.classList.toggle('active', s.id===t));
  });
</script>
</body>
</html>
